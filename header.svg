<?xml version="1.0" encoding="UTF-8"?>
<svg width="800" height="230" viewBox="0 0 800 230" xmlns="http://www.w3.org/2000/svg">
  <style>
    svg{
      /* Look & feel */
      --fontSize: 28px;
      --lineHeight: 42px;
      --fg: #C8F7C5;
      --dim: #7FD37A;
      --bg: #0B0F10;
      --cursor: #A0FFA0;
      --padX: 40px;
      --padY: 28px;
      --font: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;

      /* Timing */
      --perChar: .09s; /* duration per character */
      --pause: .6s;    /* pause between lines */
    }

    text { font: var(--fontSize) var(--font); dominant-baseline: hanging; }
    .prompt { fill: var(--dim); }
    .cmd { fill: var(--fg); }
    .glow { filter: url(#glow); }

    /* Per-line timing (computed from inline CSS variables) */
    .line { --t: calc(var(--n) * var(--perChar)); --stop: calc(var(--start) + var(--t)); }

    /* Inside each nested <svg>, the clip rect grows from 0% to 100% of that line's viewport */
    .reveal {
      height: 100%;
      width: 0%;
      animation: typing var(--t) steps(var(--n)) var(--start) forwards;
    }
    @keyframes typing { from { width: 0%; } to { width: 100%; } }

    /* Cursor rides the typing width then hides */
    .cursor {
      width: 1ch;
      height: calc(var(--fontSize) + 6px);
      y: 2px; fill: var(--cursor); opacity: 1;
      animation:
        caret var(--t) steps(var(--n)) var(--start) forwards,
        hide 1ms linear var(--stop) forwards;
    }
    @keyframes caret { from { transform: translateX(0); } to { transform: translateX(100%); } }
    @keyframes hide { to { opacity: 0; } }
  </style>

  <!-- Terminal background -->
  <rect x="0" y="0" width="100%" height="100%" rx="18" ry="18" fill="var(--bg)"/>
  <!-- macOS dots -->
  <g transform="translate(16,16)">
    <circle r="6" cx="0"  cy="0" fill="#ff5f56"/>
    <circle r="6" cx="20" cy="0" fill="#ffbd2e"/>
    <circle r="6" cx="40" cy="0" fill="#27c93f"/>
  </g>

  <!-- Glow filter -->
  <defs>
    <filter id="glow">
      <feGaussianBlur stdDeviation="1.2" result="b"/>
      <feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge>
    </filter>
  </defs>

  <!-- Static prompt -->
  <text class="prompt glow" x="40" y="28">
    <tspan x="40">keith@uiuc</tspan>
    <tspan dx="10">:</tspan>
    <tspan dx="10">~/projects/nerf-turret</tspan>
    <tspan dx="10" fill="#7aa2f7">$</tspan>
  </text>

  <!-- ===== LINE 1 ===== -->
  <!-- Nested viewport ensures clip/cursor are local to this row -->
  <g class="line" style="--n: 29; --start: 0s;">
    <svg x="40" y="70" width="720" height="42" viewBox="0 0 720 42">
      <defs>
        <clipPath id="clip1">
          <rect class="reveal" x="0" y="0" height="42"/>
        </clipPath>
      </defs>
      <text class="cmd glow" x="0" y="0" clip-path="url(#clip1)">git status && git add .</text>
      <!-- The cursor uses 100% as the typed width of this nested viewport -->
      <rect class="cursor" x="0" y="0"/>
    </svg>
  </g>

  <!-- ===== LINE 2 ===== -->
  <!-- start = prev n * perChar + pause -->
  <g class="line" style="--n: 32; --start: calc(29 * var(--perChar) + var(--pause));">
    <svg x="40" y="112" width="720" height="42" viewBox="0 0 720 42">
      <defs>
        <clipPath id="clip2">
          <rect class="reveal" x="0" y="0" height="42"/>
        </clipPath>
      </defs>
      <text class="cmd glow" x="0" y="0" clip-path="url(#clip2)">git commit -m "PID update"</text>
      <rect class="cursor" x="0" y="0"/>
    </svg>
  </g>

  <!-- ===== LINE 3 ===== -->
  <g class="line" style="--n: 24; --start: calc((29 + 32) * var(--perChar) + 2 * var(--pause));">
    <svg x="40" y="154" width="720" height="42" viewBox="0 0 720 42">
      <defs>
        <clipPath id="clip3">
          <rect class="reveal" x="0" y="0" height="42"/>
        </clipPath>
      </defs>
      <text class="cmd glow" x="0" y="0" clip-path="url(#clip3)">git push origin main</text>
      <rect class="cursor" x="0" y="0"/>
    </svg>
  </g>
</svg>
